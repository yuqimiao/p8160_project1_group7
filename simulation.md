Simulation
================
Jungang Zou
2/4/2020

# Simulation Function:

input:

  - n(required) : \#sample
  - p(required) : \#feature
  - percentage(required): vector of length 3, percentage of strong,
    weak\_correlated and weak data, must be positive, not need to be sum
    up to 1
  - c : to calculate the zone of beta, if beta is specified, this
    parameter has no use
  - mu : the mean of strong and weak\_correlated data
  - sigma : the covariance of strong and weak\_correlated data
  - beta : true beta. If beta is not specified, beta will be sample by
    formulas of c
  - seed : set the random seed.
  - error\_sigma : the variance of error term

output:

  - beta : a tibble consist of true beta, lr beta, step beta, lasso
    beta, beta type
  - data : the simulated data
  - response : the simulated response data
  - c : c is specified or calculated
  - percentage: scaled percentage
  - lr\_model : the fitted linear regression model
  - step\_model : the fitted stepwise forward model
  - lasso\_model: the fitted lasso model

The relationship between c and beta: If c is specified and beta is NULL,
then the function will calculate different zone for beta, and simulate
beta from the calculated zone by percentage. If beta is specified, c
will be no use. And new c will be calculate in function.

``` r
# this function is to calculate lasso function by cv
lasso_function = function(data, response){
  lambda_best = glmnet::cv.glmnet(x = data, y = response, alpha = 1, nfolds = 10) #cv to find best lambda
  lambda = lambda_best$lambda.min #best lambda
  lasso_best_fit = glmnet::glmnet(x = data, y = response, alpha = 1, nlambda = 1, lambda = lambda) #fit the lasso model
  lasso_best_fit
}


# This is the main function of simulation
simulation <- function(n, p, percentage, c = 1, mu = 1, sigma = 0.5, beta = NULL, seed = 100, error_sigma = 1){
  set.seed(seed) 
  
  # check input
  if (length(percentage) != 3) {
    stop("please send the 3 samples percentage")
  }
  if (p > n) {
    stop("#Features are more than #samples")
  }
  if (length(beta) > 0 && length(beta) != p) {
    stop("#Features is not consistent with #coefficient")
  }
  if (sum(percentage < 0)) {
    stop("percentage cannot be negative")
  }
  
  # scale percentage
  strong = percentage[1] / sum(percentage)
  weak_corr = percentage[2] / sum(percentage)
  weak_no_corr = percentage[3] / sum(percentage)
  corr_feature = as.integer((strong + weak_corr) * p)
  no_corr_feature = p - corr_feature
  
  
  # simulate correlated data from multivariate Guassian distribution
  data = mvrnorm(n = n, mu = rep(mu, corr_feature), Sigma = matrix(rep(sigma, corr_feature * corr_feature), nrow = corr_feature, ncol = corr_feature))
  
  # simulate uncorrelated data
  for (i in 1:no_corr_feature) {
    no_corr = rnorm(n, mu, sigma)
    data = cbind(data, no_corr)
  }
  
  # set the variable names
  data_columns_names = paste("V", 1:p)
  colnames(data) <- data_columns_names
  
  
  # if beta is specified,  calculate c
  if (length(beta) != 0) {
    strong_beta = sort(beta, decreasing = TRUE)[as.integer(strong * p) + 1]
    c = strong_beta / sqrt(log(p) / n)
  }
  
  # if beta is not specified, simulate beta by c
  if (length(beta) == 0) {
    strong_beta = runif(as.integer(strong * p), min = c * sqrt(log(p) / n) + 0.001, max = 9999)
    
    weak_corr_beta = runif(as.integer(weak_corr * p), min = 0.001, max = c * sqrt(log(p) / n))
    
    weak_beta = runif(p - as.integer(strong * p) - as.integer(weak_corr * p), min = 0.001, max = c * sqrt(log(p) / n))
    
    beta = c(strong_beta, weak_corr_beta, weak_beta)
    
    beta_sign = runif(length(beta), -1, 1)
    beta_sign = beta_sign / abs(beta_sign)
    beta = beta * beta_sign
  }
  
  # calculate response variable
  error_term = rnorm(n, mean = 0, sd = error_sigma)
  response = data %*% beta + error_term
  
  
  # regression
  lr = lm(response ~ data)
  step_lr = step(lm(response ~ data), direction = "forward")
  lasso = lasso_function(data, response)

  
  # collect beta as tibble
  beta_result = tibble(
      "true beta" = beta,
      "lr coefficient" = coefficients(lr)[2:length(coefficients(lr))],
      "step coefficient" = coefficients(step_lr)[2:length(coefficients(step_lr))],
      "lasso coefficient" = as.vector(coefficients(lasso))[2:length(coefficients(lasso))],
      "type" = c(rep("strong", as.integer(strong * p)), rep("weak_corr", as.integer(weak_corr * p)), rep("weak", p - as.integer(strong * p) - as.integer(weak_corr * p)))
      ) %>% 
    replace(is.na(.), 0)
  
  # collect output
  result = list(beta = beta_result, data = data, response = response, c = c, percentage = c(strong, weak_corr, weak_no_corr), lr_model = lr, step_model = step_lr, lasso_model = lasso)
  return(result)
}


a = simulation(100, 10, c(1,3, 2))
```

    ## Start:  AIC=4.79
    ## response ~ data

``` r
a
```

    ## $beta
    ## # A tibble: 10 x 5
    ##    `true beta` `lr coefficient` `step coefficien… `lasso coefficien… type  
    ##          <dbl>            <dbl>             <dbl>              <dbl> <chr> 
    ##  1   8637.            8637.             8637.                  8386. strong
    ##  2     -0.117            0                 0                      0  weak_…
    ##  3      0.134            0                 0                      0  weak_…
    ##  4     -0.0348           0                 0                      0  weak_…
    ##  5      0.110            0                 0                      0  weak_…
    ##  6      0.105            0                 0                      0  weak_…
    ##  7     -0.130            0.100             0.100                  0  weak  
    ##  8     -0.0361          -0.0259           -0.0259                 0  weak  
    ##  9     -0.132            0.0388            0.0388                 0  weak  
    ## 10     -0.0633          -0.206            -0.206                  0  weak  
    ## 
    ## $data
    ##                V 1         V 2         V 3         V 4         V 5
    ##   [1,]  0.64489637  0.64489639  0.64489639  0.64489639  0.64489639
    ##   [2,]  1.09300662  1.09300657  1.09300657  1.09300657  1.09300657
    ##   [3,]  0.94419718  0.94419720  0.94419719  0.94419719  0.94419719
    ##   [4,]  1.62705158  1.62705155  1.62705155  1.62705155  1.62705155
    ##   [5,]  1.08271114  1.08271120  1.08271118  1.08271118  1.08271118
    ##   [6,]  1.22530548  1.22530549  1.22530550  1.22530550  1.22530550
    ##   [7,]  0.58861184  0.58861186  0.58861187  0.58861187  0.58861187
    ##   [8,]  1.50525092  1.50525092  1.50525093  1.50525093  1.50525093
    ##   [9,]  0.41645350  0.41645343  0.41645346  0.41645346  0.41645346
    ##  [10,]  0.74553904  0.74553905  0.74553905  0.74553905  0.74553905
    ##  [11,]  1.06355911  1.06355911  1.06355910  1.06355910  1.06355910
    ##  [12,]  1.06807633  1.06807633  1.06807632  1.06807632  1.06807632
    ##  [13,]  0.85742325  0.85742326  0.85742327  0.85742327  0.85742327
    ##  [14,]  1.52314620  1.52314623  1.52314624  1.52314624  1.52314624
    ##  [15,]  1.08724247  1.08724247  1.08724249  1.08724249  1.08724249
    ##  [16,]  0.97926996  0.97926997  0.97926995  0.97926995  0.97926995
    ##  [17,]  0.72503855  0.72503852  0.72503852  0.72503852  0.72503852
    ##  [18,]  1.36122992  1.36122992  1.36122993  1.36122993  1.36122993
    ##  [19,]  0.35383578  0.35383580  0.35383579  0.35383579  0.35383579
    ##  [20,]  2.63362659  2.63362654  2.63362654  2.63362654  2.63362654
    ##  [21,]  0.69022358  0.69022359  0.69022361  0.69022361  0.69022361
    ##  [22,]  1.54027245  1.54027244  1.54027244  1.54027244  1.54027244
    ##  [23,]  1.18523459  1.18523461  1.18523461  1.18523461  1.18523461
    ##  [24,]  1.54687965  1.54687963  1.54687963  1.54687963  1.54687963
    ##  [25,]  0.42414696  0.42414701  0.42414701  0.42414701  0.42414701
    ##  [26,]  0.68996862  0.68996863  0.68996863  0.68996863  0.68996863
    ##  [27,]  0.49072645  0.49072647  0.49072646  0.49072646  0.49072646
    ##  [28,]  1.16330247  1.16330243  1.16330244  1.16330244  1.16330244
    ##  [29,]  0.18136163  0.18136166  0.18136165  0.18136165  0.18136165
    ##  [30,]  1.17470912  1.17470910  1.17470911  1.17470911  1.17470911
    ##  [31,]  0.93557297  0.93557299  0.93557298  0.93557298  0.93557298
    ##  [32,]  2.24265220  2.24265223  2.24265222  2.24265222  2.24265222
    ##  [33,]  0.90246905  0.90246903  0.90246903  0.90246903  0.90246903
    ##  [34,]  0.92137431  0.92137431  0.92137433  0.92137433  0.92137433
    ##  [35,]  0.51208623  0.51208618  0.51208619  0.51208619  0.51208619
    ##  [36,]  0.84316781  0.84316779  0.84316779  0.84316779  0.84316779
    ##  [37,]  1.12933526  1.12933526  1.12933527  1.12933527  1.12933527
    ##  [38,]  1.29509214  1.29509213  1.29509212  1.29509212  1.29509212
    ##  [39,]  1.75335321  1.75335322  1.75335321  1.75335321  1.75335321
    ##  [40,]  1.68603644  1.68603643  1.68603642  1.68603642  1.68603642
    ##  [41,]  0.92813727  0.92813727  0.92813728  0.92813728  0.92813728
    ##  [42,]  1.99221464  1.99221474  1.99221471  1.99221471  1.99221471
    ##  [43,] -0.25637009 -0.25637011 -0.25637010 -0.25637010 -0.25637010
    ##  [44,]  1.44043377  1.44043374  1.44043376  1.44043376  1.44043376
    ##  [45,]  0.63068987  0.63068991  0.63068991  0.63068991  0.63068991
    ##  [46,]  1.93495844  1.93495851  1.93495847  1.93495847  1.93495847
    ##  [47,]  0.74300887  0.74300888  0.74300888  0.74300888  0.74300888
    ##  [48,]  1.93272032  1.93272032  1.93272034  1.93272034  1.93272034
    ##  [49,]  1.03095649  1.03095647  1.03095647  1.03095647  1.03095647
    ##  [50,] -0.32841031 -0.32841029 -0.32841032 -0.32841032 -0.32841032
    ##  [51,]  0.68387933  0.68387929  0.68387930  0.68387930  0.68387930
    ##  [52,] -0.22937435 -0.22937441 -0.22937441 -0.22937441 -0.22937441
    ##  [53,]  1.12647655  1.12647654  1.12647655  1.12647655  1.12647655
    ##  [54,]  2.34171086  2.34171087  2.34171086  2.34171086  2.34171086
    ##  [55,] -0.60649391 -0.60649391 -0.60649392 -0.60649392 -0.60649392
    ##  [56,]  1.69329283  1.69329284  1.69329284  1.69329284  1.69329284
    ##  [57,]  0.01088092  0.01088090  0.01088093  0.01088093  0.01088093
    ##  [58,]  2.29037966  2.29037968  2.29037966  2.29037966  2.29037966
    ##  [59,]  1.97672571  1.97672569  1.97672570  1.97672570  1.97672570
    ##  [60,]  0.40684215  0.40684215  0.40684215  0.40684215  0.40684215
    ##  [61,]  0.81474100  0.81474101  0.81474101  0.81474101  0.81474101
    ##  [62,]  0.95131992  0.95131992  0.95131992  0.95131992  0.95131992
    ##  [63,]  0.73208886  0.73208886  0.73208887  0.73208887  0.73208887
    ##  [64,]  2.82572069  2.82572067  2.82572066  2.82572066  2.82572066
    ##  [65,]  1.09180660  1.09180661  1.09180660  1.09180660  1.09180660
    ##  [66,]  0.49581518  0.49581521  0.49581520  0.49581520  0.49581520
    ##  [67,]  1.45113005  1.45113007  1.45113005  1.45113005  1.45113005
    ##  [68,]  1.14261747  1.14261749  1.14261750  1.14261750  1.14261750
    ##  [69,]  0.95056126  0.95056125  0.95056125  0.95056125  0.95056125
    ##  [70,]  0.93459980  0.93459979  0.93459977  0.93459977  0.93459977
    ##  [71,]  1.31742257  1.31742255  1.31742254  1.31742254  1.31742254
    ##  [72,]  0.24738689  0.24738689  0.24738689  0.24738689  0.24738689
    ##  [73,]  0.17804541  0.17804543  0.17804541  0.17804541  0.17804541
    ##  [74,]  2.16568091  2.16568090  2.16568091  2.16568091  2.16568091
    ##  [75,] -0.45812208 -0.45812207 -0.45812208 -0.45812208 -0.45812208
    ##  [76,]  1.00901536  1.00901542  1.00901543  1.00901543  1.00901543
    ##  [77,]  0.23100134  0.23100133  0.23100133  0.23100133  0.23100133
    ##  [78,]  1.19130030  1.19130031  1.19130031  1.19130031  1.19130031
    ##  [79,]  1.71308319  1.71308316  1.71308315  1.71308315  1.71308315
    ##  [80,] -0.46682561 -0.46682571 -0.46682567 -0.46682567 -0.46682567
    ##  [81,]  1.63414908  1.63414913  1.63414911  1.63414911  1.63414911
    ##  [82,]  0.96464767  0.96464765  0.96464765  0.96464765  0.96464765
    ##  [83,]  0.04869438  0.04869439  0.04869438  0.04869438  0.04869438
    ##  [84,] -0.36557279 -0.36557276 -0.36557277 -0.36557277 -0.36557277
    ##  [85,]  1.50174997  1.50174995  1.50174994  1.50174994  1.50174994
    ##  [86,]  0.88834430  0.88834428  0.88834428  0.88834428  0.88834428
    ##  [87,]  1.15299519  1.15299520  1.15299519  1.15299519  1.15299519
    ##  [88,]  1.57796226  1.57796227  1.57796227  1.57796227  1.57796227
    ##  [89,]  2.22129766  2.22129770  2.22129769  2.22129769  2.22129769
    ##  [90,]  0.92662331  0.92662333  0.92662333  0.92662333  0.92662333
    ##  [91,]  0.60605504  0.60605506  0.60605505  0.60605505  0.60605505
    ##  [92,]  2.00996162  2.00996162  2.00996163  2.00996163  2.00996163
    ##  [93,]  0.36858379  0.36858376  0.36858376  0.36858376  0.36858376
    ##  [94,]  0.18147352  0.18147353  0.18147353  0.18147353  0.18147353
    ##  [95,]  0.62502383  0.62502376  0.62502377  0.62502377  0.62502377
    ##  [96,]  2.72935885  2.72935886  2.72935887  2.72935887  2.72935887
    ##  [97,]  0.41133662  0.41133657  0.41133657  0.41133657  0.41133657
    ##  [98,]  1.29240269  1.29240271  1.29240268  1.29240268  1.29240268
    ##  [99,]  0.16654513  0.16654517  0.16654516  0.16654516  0.16654516
    ## [100,]  0.16983208  0.16983205  0.16983206  0.16983206  0.16983206
    ##                V 6          V 7         V 8        V 9        V 10
    ##   [1,]  0.64489639  1.967119069  1.25357109 0.84224098  1.08874963
    ##   [2,]  1.09300657  0.993708182  1.02783993 1.93535919  0.74813729
    ##   [3,]  0.94419719  0.374057452  1.68984258 1.13839393  1.05251552
    ##   [4,]  1.62705155  1.387398081  1.44530773 0.68384828  0.41042316
    ##   [5,]  1.08271118  1.401944982  0.26135003 1.45919377  1.41844876
    ##   [6,]  1.22530550  0.250618824  2.00453850 1.10531714  1.13058810
    ##   [7,]  0.58861187  1.292927745  1.45258720 0.04285430  0.50954592
    ##   [8,]  1.50525093  0.579671769  1.31485829 0.85391002  2.11633814
    ##   [9,]  0.41645346  0.613007827  1.64029345 0.18181567  0.70740168
    ##  [10,]  0.74553905  0.395724555  0.30179125 0.69440232  0.54675397
    ##  [11,]  1.06355910  1.009412191  1.03893916 0.77327358  0.55178203
    ##  [12,]  1.06807632  0.316333897  0.13627855 1.67875829  0.73554024
    ##  [13,]  0.85742327  0.004945539  1.38570249 0.26345959  1.12959712
    ##  [14,]  1.52314624 -0.078097566  1.07818733 1.05145884  0.88984539
    ##  [15,]  1.08724249  1.033587790  0.74381057 1.09909684  1.77021126
    ##  [16,]  0.97926995  1.430126774  1.12992613 0.78019873  0.37737518
    ##  [17,]  0.72503852  0.608355798  1.60082900 0.62787868  1.62678103
    ##  [18,]  1.36122993  0.721909765  1.21768552 1.37095382  0.87833534
    ##  [19,]  0.35383579  1.353475361  1.16189773 1.23761848  0.68862985
    ##  [20,]  2.63362654  1.095783957  1.55623413 1.12162812  0.49291503
    ##  [21,]  0.69022361  1.819839030  2.19376801 1.13237810  0.97404246
    ##  [22,]  1.54027244  0.912231509  1.36914349 1.82167427  0.55114448
    ##  [23,]  1.18523461  0.818765951  0.54956785 1.49350579  0.53456310
    ##  [24,]  1.54687963  2.080791022  1.37897039 0.82654721  1.62588295
    ##  [25,]  0.42414701  0.934963573  1.65362864 0.92601703  1.89998169
    ##  [26,]  0.68996863  0.343514454  1.22343175 0.86289462  0.68579785
    ##  [27,]  0.49072646  1.329878593  0.57438528 1.61620064  0.90435594
    ##  [28,]  1.16330244  1.045901607  0.47602637 0.79625327  0.37859564
    ##  [29,]  0.18136165  1.224036151  1.00199688 0.45418240  0.90313643
    ##  [30,]  1.17470911  1.272041795  0.29020789 1.29286279  1.21473868
    ##  [31,]  0.93557298  1.810388707  1.24774603 1.48555862  1.07171436
    ##  [32,]  2.24265222  1.660645514  1.48214742 1.34186160  0.87252737
    ##  [33,]  0.90246903  0.951079138  1.25736756 1.52276867  0.63974308
    ##  [34,]  0.92137433  1.192116769  0.44464502 1.08216948  1.07275418
    ##  [35,]  0.51208619  1.387520938  0.85376633 0.13133971  0.03584115
    ##  [36,]  0.84316779  1.203224065  1.96200994 1.17976637  0.60676561
    ##  [37,]  1.12933527  0.986608433 -0.18035685 1.55204054  1.39510678
    ##  [38,]  1.29509212  1.670529827  0.78728013 1.35754193  0.62749833
    ##  [39,]  1.75335321  1.372454633  0.90009357 0.65855281 -0.25130580
    ##  [40,]  1.68603642  0.776665557  1.54063858 1.39603792  0.21977047
    ##  [41,]  0.92813728  0.631584827  0.70957488 1.66128649  1.76343982
    ##  [42,]  1.99221471  0.574713295  0.89413038 2.00276102  1.93294403
    ##  [43,] -0.25637010  0.329962946  0.79382115 1.64275582  0.08777659
    ##  [44,]  1.44043376  1.329138926  1.19773140 1.05852871  1.28201222
    ##  [45,]  0.63068991  0.821822532  0.33141167 1.46748292  0.81919111
    ##  [46,]  1.93495847  1.024720868  2.15565894 1.66650792  0.70784602
    ##  [47,]  0.74300888  0.457329429  0.82475449 1.49076707  1.30450496
    ##  [48,]  1.93272034  1.018326425  0.83944834 1.32807558  1.26389491
    ##  [49,]  1.03095647 -0.311800989  0.78551920 1.50347949  0.82755808
    ##  [50,] -0.32841032 -0.073656424  0.88519437 0.19458513  0.66289038
    ##  [51,]  0.68387930  1.546241813  0.97204099 0.87205334  0.84927563
    ##  [52,] -0.22937441  0.157828837  0.81397728 1.95408766  0.71623908
    ##  [53,]  1.12647655  0.746777291  1.23714998 1.35077497  0.24359920
    ##  [54,]  2.34171086  0.354999223  0.96914768 0.65715238  1.59366102
    ##  [55,] -0.60649392  0.669819151 -0.06384453 0.83118621  0.36207219
    ##  [56,]  1.69329284  1.055578220  0.49888147 0.48930419  0.66253729
    ##  [57,]  0.01088093  1.844090878  0.74109774 1.82531437  0.78886070
    ##  [58,]  2.29037966  1.720974747  2.10510487 0.12405157  0.37151719
    ##  [59,]  1.97672570  1.103907843  1.16249222 1.90174638  0.60056089
    ##  [60,]  0.40684215  0.732315316  0.36159557 0.30117062  1.56885163
    ##  [61,]  0.81474101  1.126101983  2.03931317 1.76233962  1.36826317
    ##  [62,]  0.95131992  0.515751847  1.27545942 2.12247882  1.79262083
    ##  [63,]  0.73208887  1.025976001  2.00524023 1.22486340  1.55141907
    ##  [64,]  2.82572066  1.636291488  0.85621205 1.07405702  0.50870412
    ##  [65,]  1.09180660  0.766220544  1.24075288 0.84626185  1.41626506
    ##  [66,]  0.49581520  0.732037319  0.31073874 1.68790676  0.21541575
    ##  [67,]  1.45113005  1.415760929  1.46145527 1.77614109  1.65884074
    ##  [68,]  1.14261750  1.177509592  0.59015459 0.97915974  1.76707533
    ##  [69,]  0.95056125  1.226019483  0.67528007 0.50051829  0.98793393
    ##  [70,]  0.93459977  1.439756689  1.74455219 1.58695960  0.69517407
    ##  [71,]  1.31742254  0.945799397  0.52939258 1.06468971  1.05581805
    ##  [72,]  0.24738689 -0.219060506  0.41299753 0.95975023  1.19134070
    ##  [73,]  0.17804541  1.367757449  1.39655597 1.12249678  0.52464015
    ##  [74,]  2.16568091  0.265778490  0.60195826 0.76636218  1.64377337
    ##  [75,] -0.45812208  1.188597472  1.49472391 1.02488687  1.42902846
    ##  [76,]  1.00901543  1.332282692  2.05360147 2.54612493  1.49136268
    ##  [77,]  0.23100133  0.972467751  1.91365351 1.50089261  0.84231547
    ##  [78,]  1.19130031  1.084810308  1.19638895 0.76713026  1.01623065
    ##  [79,]  1.71308315  1.599554421  0.95217224 1.25037403  1.39551840
    ##  [80,] -0.46682567  1.414803823  1.37016408 0.43302515  1.16974832
    ##  [81,]  1.63414911  1.649965821  1.56765532 0.35140088  1.47230234
    ##  [82,]  0.96464765  0.359560710  1.39671676 0.55426929  1.28439638
    ##  [83,]  0.04869438  0.532200278  1.37843866 0.67121614  1.12920840
    ##  [84,] -0.36557277  1.183688832  0.84341259 0.86577871  0.88596492
    ##  [85,]  1.50174994  0.994846184 -0.24639430 0.08526254  1.15519476
    ##  [86,]  0.88834428  0.704893002  0.96247370 1.11419012  0.19606061
    ##  [87,]  1.15299519  1.462609070  0.53634152 1.34976486  0.55129488
    ##  [88,]  1.57796227  0.953002843  1.61741060 1.64334316  1.42784781
    ##  [89,]  2.22129769  1.489474174  1.09165679 0.32119695  0.01896872
    ##  [90,]  0.92662333  0.550661241  1.41918299 1.03324069  1.47436048
    ##  [91,]  0.60605505  1.118653211  1.33531428 1.28107800  1.05202700
    ##  [92,]  2.00996163  0.646050954  0.31796977 1.09019954  0.47787136
    ##  [93,]  0.36858376  0.347501280  1.33263671 0.05789488  1.35476005
    ##  [94,]  0.18147353  1.413688352  1.36311131 2.17132927  1.08764666
    ##  [95,]  0.62502377  1.291071955  1.14687125 1.40618885  0.47076514
    ##  [96,]  2.72935887  0.321347071  0.53261053 0.98243286  0.65967318
    ##  [97,]  0.41133657  1.159433774  1.62423848 0.55656540  0.49266153
    ##  [98,]  1.29240268  0.868628954  0.15514682 1.23451160  2.16830763
    ##  [99,]  0.16654516  0.407995315  1.74118865 1.85043702  0.41427499
    ## [100,]  0.16983206  1.093626352  1.54562164 1.83564331 -0.07071383
    ## 
    ## $response
    ##               [,1]
    ##   [1,]  5568.80245
    ##   [2,]  9439.16016
    ##   [3,]  8155.76322
    ##   [4,] 14053.33788
    ##   [5,]  9350.44106
    ##   [6,] 10583.76594
    ##   [7,]  5083.71724
    ##   [8,] 13000.62073
    ##   [9,]  3596.63384
    ##  [10,]  6439.19273
    ##  [11,]  9186.29671
    ##  [12,]  9225.32947
    ##  [13,]  7406.45094
    ##  [14,] 13155.93738
    ##  [15,]  9390.13956
    ##  [16,]  8458.42975
    ##  [17,]  6261.40937
    ##  [18,] 11757.17730
    ##  [19,]  3056.38350
    ##  [20,] 22747.24652
    ##  [21,]  5962.55243
    ##  [22,] 13302.96643
    ##  [23,] 10237.36749
    ##  [24,] 13359.87476
    ##  [25,]  3661.78825
    ##  [26,]  5958.89157
    ##  [27,]  4239.33848
    ##  [28,] 10047.66680
    ##  [29,]  1565.85274
    ##  [30,] 10147.44186
    ##  [31,]  8081.28283
    ##  [32,] 19371.47840
    ##  [33,]  7795.39775
    ##  [34,]  7958.38617
    ##  [35,]  4422.60283
    ##  [36,]  7282.92335
    ##  [37,]  9753.06800
    ##  [38,] 11185.94226
    ##  [39,] 15144.83208
    ##  [40,] 14563.32820
    ##  [41,]  8016.37277
    ##  [42,] 17205.90354
    ##  [43,] -2214.37356
    ##  [44,] 12442.24026
    ##  [45,]  5448.63375
    ##  [46,] 16711.60504
    ##  [47,]  6417.44157
    ##  [48,] 16693.89448
    ##  [49,]  8905.44107
    ##  [50,] -2836.79058
    ##  [51,]  5906.81652
    ##  [52,] -1981.13336
    ##  [53,]  9729.89456
    ##  [54,] 20223.42152
    ##  [55,] -5238.89122
    ##  [56,] 14625.94898
    ##  [57,]    94.34668
    ##  [58,] 19782.13480
    ##  [59,] 17074.75833
    ##  [60,]  3512.93027
    ##  [61,]  7038.23178
    ##  [62,]  8216.28751
    ##  [63,]  6323.50675
    ##  [64,] 24409.84230
    ##  [65,]  9430.23921
    ##  [66,]  4281.43819
    ##  [67,] 12534.41103
    ##  [68,]  9870.05903
    ##  [69,]  8212.64015
    ##  [70,]  8073.65989
    ##  [71,] 11378.21302
    ##  [72,]  2136.93573
    ##  [73,]  1537.90232
    ##  [74,] 18705.93356
    ##  [75,] -3958.98765
    ##  [76,]  8712.40413
    ##  [77,]  1995.48800
    ##  [78,] 10290.00036
    ##  [79,] 14797.23198
    ##  [80,] -4034.12704
    ##  [81,] 14114.65665
    ##  [82,]  8330.64092
    ##  [83,]   420.31285
    ##  [84,] -3158.04630
    ##  [85,] 12969.57841
    ##  [86,]  7673.51134
    ##  [87,]  9956.99905
    ##  [88,] 13629.80033
    ##  [89,] 19186.54633
    ##  [90,]  8004.10609
    ##  [91,]  5234.59449
    ##  [92,] 17359.49246
    ##  [93,]  3184.23549
    ##  [94,]  1567.78857
    ##  [95,]  5397.56601
    ##  [96,] 23572.92982
    ##  [97,]  3552.97950
    ##  [98,] 11165.26426
    ##  [99,]  1438.49113
    ## [100,]  1465.51789
    ## 
    ## $c
    ## [1] 1
    ## 
    ## $percentage
    ## [1] 0.1666667 0.5000000 0.3333333
    ## 
    ## $lr_model
    ## 
    ## Call:
    ## lm(formula = response ~ data)
    ## 
    ## Coefficients:
    ## (Intercept)      dataV 1      dataV 2      dataV 3      dataV 4  
    ##    -0.21726   8637.49154           NA           NA           NA  
    ##     dataV 5      dataV 6      dataV 7      dataV 8      dataV 9  
    ##          NA           NA      0.10027     -0.02588      0.03882  
    ##    dataV 10  
    ##    -0.20558  
    ## 
    ## 
    ## $step_model
    ## 
    ## Call:
    ## lm(formula = response ~ data)
    ## 
    ## Coefficients:
    ## (Intercept)      dataV 1      dataV 2      dataV 3      dataV 4  
    ##    -0.21726   8637.49154           NA           NA           NA  
    ##     dataV 5      dataV 6      dataV 7      dataV 8      dataV 9  
    ##          NA           NA      0.10027     -0.02588      0.03882  
    ##    dataV 10  
    ##    -0.20558  
    ## 
    ## 
    ## $lasso_model
    ## 
    ## Call:  glmnet::glmnet(x = data, y = response, alpha = 1, nlambda = 1,      lambda = lambda) 
    ## 
    ##   Df   %Dev Lambda
    ## 1  1 0.9992  180.8
